<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>29 - IIFE</title>
    <link rel="stylesheet" href="../fundamentos/styles.css">
</head>
<body>
    <a href="../JavaScriptCami.html" class="back">â† Volver al menÃº</a>
    <h1>29 - IIFE (Funciones AnÃ³nimas Autoejecutablees)</h1>
    
    <div class="code-section">
        <h2>ğŸ“Œ Â¿QuÃ© es una IIFE?</h2>
        <p>IIFE (Immediately Invoked Function Expression) es una funciÃ³n que se ejecuta inmediatamente despuÃ©s de ser definida.</p>
    </div>
 
    <div class="code-section">
        <h2>ğŸ”§ Sintaxis</h2>
        <pre><code>// Forma 1
(function() {
    console.log("Se ejecuta inmediatamente");
})();

// Forma 2
(function() {
    console.log("TambiÃ©n se ejecuta");
}());

// Con arrow function
(() => {
    console.log("Arrow IIFE");
})();</code></pre>
    </div>

    <h2>ğŸ’» Ejemplos PrÃ¡cticos</h2>
    <div id="ejemplos"></div>

    <script>
        let ejemploNumero = 0;
        const ejemplosContainer = document.getElementById('ejemplos');

        function iniciarEjemplo(titulo) {
            ejemploNumero++;
            const div = document.createElement('div');
            div.className = 'ejemplo-box';
            div.id = 'ejemplo-' + ejemploNumero;
            div.innerHTML = `
                <div class="ejemplo-header">
                    <span class="ejemplo-numero">ğŸ“Œ EJEMPLO ${ejemploNumero}</span>
                    <span class="ejemplo-titulo">${titulo}</span>
                </div>
                <div class="ejemplo-contenido"></div>
            `;
            ejemplosContainer.appendChild(div);
        }

        function mostrar(texto, tipo = 'normal') {
            const ejemploActual = document.getElementById('ejemplo-' + ejemploNumero);
            if (ejemploActual) {
                const contenido = ejemploActual.querySelector('.ejemplo-contenido');
                const linea = document.createElement('div');
                linea.className = 'linea-' + tipo;
                linea.textContent = texto;
                contenido.appendChild(linea);
            }
        }

        function mostrarCodigo(codigo) {
            const ejemploActual = document.getElementById('ejemplo-' + ejemploNumero);
            if (ejemploActual) {
                const contenido = ejemploActual.querySelector('.ejemplo-contenido');
                const codigoDiv = document.createElement('div');
                codigoDiv.className = 'codigo-ejemplo';
                codigoDiv.textContent = codigo;
                contenido.appendChild(codigoDiv);
            }
        }

        function mostrarResultado(texto) {
            mostrar('âœ ' + texto, 'resultado');
        }

        const style = document.createElement('style');
        style.textContent = `
            .ejemplo-box {
                background: white;
                border: 2px solid #f7df1e;
                border-radius: 8px;
                margin: 20px 0;
                overflow: hidden;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            .ejemplo-header {
                background: linear-gradient(135deg, #f7df1e 0%, #e5ca00 100%);
                padding: 15px 20px;
                font-weight: bold;
                display: flex;
                align-items: center;
                gap: 15px;
            }
            .ejemplo-numero {
                background: #333;
                color: #f7df1e;
                padding: 5px 15px;
                border-radius: 20px;
                font-size: 0.9em;
            }
            .ejemplo-titulo {
                color: #333;
                font-size: 1.1em;
            }
            .ejemplo-contenido {
                padding: 20px;
                background: #f9f9f9;
            }
            .codigo-ejemplo {
                background: #282c34;
                color: #61dafb;
                padding: 12px 15px;
                border-radius: 5px;
                font-family: 'Courier New', monospace;
                margin: 8px 0;
                border-left: 4px solid #f7df1e;
            }
            .linea-normal {
                color: #666;
                padding: 5px 0;
            }
            .linea-resultado {
                color: #2ecc71;
                padding: 8px 15px;
                background: #e8f8f5;
                border-left: 4px solid #2ecc71;
                margin: 5px 0;
                border-radius: 3px;
                font-weight: 500;
                font-family: 'Courier New', monospace;
            }
        `;
        document.head.appendChild(style);

        // EJEMPLO 1: IIFE bÃ¡sica
        iniciarEjemplo("IIFE bÃ¡sica");
        
        mostrarCodigo('(function() {');
        mostrarCodigo('    const mensaje = "Hola desde IIFE";');
        mostrarCodigo('    console.log(mensaje);');
        mostrarCodigo('})();');
        
        (function() {
            const mensaje = "Hola desde IIFE";
            mostrarResultado(mensaje);
        })();

        // EJEMPLO 2: IIFE con parÃ¡metros
        iniciarEjemplo("IIFE con parÃ¡metros");
        
        mostrarCodigo('(function(nombre, edad) {');
        mostrarCodigo('    console.log(`${nombre} tiene ${edad} aÃ±os`);');
        mostrarCodigo('})("Ana", 25);');
        
        (function(nombre, edad) {
            mostrarResultado(`${nombre} tiene ${edad} aÃ±os`);
        })("Ana", 25);

        // EJEMPLO 3: IIFE con return
        iniciarEjemplo("IIFE que retorna un valor");
        
        mostrarCodigo('const resultado = (function() {');
        mostrarCodigo('    return 5 + 3;');
        mostrarCodigo('})();');
        
        const resultado = (function() {
            return 5 + 3;
        })();
        
        mostrarResultado('Resultado: ' + resultado);

        // EJEMPLO 4: Variables privadas
        iniciarEjemplo("Encapsular variables privadas");
        
        mostrarCodigo('const contador = (function() {');
        mostrarCodigo('    let count = 0;');
        mostrarCodigo('    return {');
        mostrarCodigo('        incrementar: () => ++count,');
        mostrarCodigo('        valor: () => count');
        mostrarCodigo('    };');
        mostrarCodigo('})();');
        
        const contador = (function() {
            let count = 0;
            return {
                incrementar: () => ++count,
                valor: () => count
            };
        })();
        
        mostrar('');
        mostrarResultado('Valor inicial: ' + contador.valor());
        contador.incrementar();
        contador.incrementar();
        mostrarResultado('DespuÃ©s de incrementar 2 veces: ' + contador.valor());
        mostrar('');
        mostrar('ğŸ’¡ La variable count es privada, no se puede acceder directamente');

        // EJEMPLO 5: Evitar contaminar scope global
        iniciarEjemplo("Evitar contaminar el scope global");
        
        mostrarCodigo('(function() {');
        mostrarCodigo('    const privada = "No contamino el scope global";');
        mostrarCodigo('    console.log(privada);');
        mostrarCodigo('})();');
        
        (function() {
            const privada = "No contamino el scope global";
            mostrarResultado(privada);
        })();
        
        mostrar('');
        mostrar('ğŸ’¡ La variable "privada" solo existe dentro de la IIFE');

        // EJEMPLO 6: MÃ³dulo pattern
        iniciarEjemplo("Module Pattern con IIFE");
        
        mostrarCodigo('const calculadora = (function() {');
        mostrarCodigo('    function sumar(a, b) { return a + b; }');
        mostrarCodigo('    function restar(a, b) { return a - b; }');
        mostrarCodigo('    return { sumar, restar };');
        mostrarCodigo('})();');
        
        const calculadora = (function() {
            function sumar(a, b) { return a + b; }
            function restar(a, b) { return a - b; }
            return { sumar, restar };
        })();
        
        mostrar('');
        mostrarResultado('5 + 3 = ' + calculadora.sumar(5, 3));
        mostrarResultado('10 - 4 = ' + calculadora.restar(10, 4));

        // EJEMPLO 7: Arrow IIFE
        iniciarEjemplo("IIFE con arrow function");
        
        mostrarCodigo('(() => {');
        mostrarCodigo('    const mensaje = "Arrow IIFE";');
        mostrarCodigo('    console.log(mensaje);');
        mostrarCodigo('})();');
        
        (() => {
            const mensaje = "Arrow IIFE";
            mostrarResultado(mensaje);
        })();

        // EJEMPLO 8: Caso prÃ¡ctico - InicializaciÃ³n
        iniciarEjemplo("Caso prÃ¡ctico - Inicializar configuraciÃ³n");
        
        mostrarCodigo('const config = (function() {');
        mostrarCodigo('    const API_KEY = "secret123";');
        mostrarCodigo('    const BASE_URL = "https://api.ejemplo.com";');
        mostrarCodigo('    return {');
        mostrarCodigo('        getUrl: () => BASE_URL,');
        mostrarCodigo('        isProduction: () => true');
        mostrarCodigo('    };');
        mostrarCodigo('})();');
        
        const config = (function() {
            const API_KEY = "secret123";
            const BASE_URL = "https://api.ejemplo.com";
            return {
                getUrl: () => BASE_URL,
                isProduction: () => true
            };
        })();
        
        mostrar('');
        mostrarResultado('URL Base: ' + config.getUrl());
        mostrarResultado('Es producciÃ³n: ' + config.isProduction());
        mostrar('');
        mostrar('ğŸ’¡ API_KEY estÃ¡ oculta y protegida');
    </script>

    <div class="code-section">
        <h2>âœ¨ Ventajas de IIFE</h2>
        <ul>
            <li>âœ… Evita contaminar el scope global</li>
            <li>âœ… Crea variables y funciones privadas</li>
            <li>âœ… Se ejecuta inmediatamente</li>
            <li>âœ… Ãštil para inicializaciÃ³n de cÃ³digo</li>
            <li>âœ… PatrÃ³n Module (antes de ES6 modules)</li>
        </ul>
    </div>

    <div class="code-section">
        <h2>ğŸ“‹ Resumen</h2>
        <ul>
            <li>âœ… Sintaxis: <code>(function() { })();</code></li>
            <li>âœ… Se ejecuta inmediatamente</li>
            <li>âœ… Crea scope privado</li>
            <li>âœ… Puede retornar valores u objetos</li>
        </ul>
    </div>
</body>
</html>
